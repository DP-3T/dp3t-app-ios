name: build

on:
  push:
    branches: '**'

jobs:
  build_release_prod:
    runs-on: macOS-latest

    steps:
    - uses: actions/checkout@v2

    - name: Switch to Xcode 11.4.1
      run: sudo xcode-select --switch /Applications/Xcode_11.4.app
    
    - name: Sets up bundler
      run: bundle update --bundler
    
    - name: Sign and build
      env:
        APP_SCHEME: "Release-Prod"
      run: bundle exec fastlane sign_and_build

  build_release_dev:
    runs-on: macOS-latest

    steps:
    - uses: actions/checkout@v2

    - name: Switch to Xcode 11.4.1
      run: sudo xcode-select --switch /Applications/Xcode_11.4.app

    - name: Sets up bundler
      run: bundle update --bundler

    - name: Sign and build
      env:
        APP_SCHEME: "Release-Internal"
      run: bundle exec fastlane sign_and_build
